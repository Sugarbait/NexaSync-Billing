(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{314:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(95155),s=t(12115),l=t(20063),n=t(3941),i=t(8829),d=t(70667);let c=(0,t(71847).A)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);var o=t(78874),u=t(15239);function m(){let e=(0,l.useRouter)(),r=(0,l.useSearchParams)().get("token"),[t,m]=(0,s.useState)(!0),[g,x]=(0,s.useState)(!1),[b,f]=(0,s.useState)(null),[y,h]=(0,s.useState)({full_name:"",password:"",confirmPassword:""}),[p,v]=(0,s.useState)(!1),[j,k]=(0,s.useState)("");async function N(){try{let{data:e,error:t}=await n.N.from("user_invites").select("*").eq("invite_token",r).eq("status","pending").single();if(t||!e){k("Invalid or expired invitation"),x(!1);return}let a=new Date,s=new Date(e.expires_at);if(a>s){k("This invitation has expired"),x(!1);return}f(e),x(!0)}catch(e){console.error("Failed to validate invite:",e),k("Failed to validate invitation"),x(!1)}finally{m(!1)}}async function w(r){if(r.preventDefault(),k(""),y.password!==y.confirmPassword)return void k("Passwords do not match");if(y.password.length<8)return void k("Password must be at least 8 characters");v(!0);try{let{data:r,error:t}=await n.N.auth.signUp({email:b.email,password:y.password,options:{data:{full_name:y.full_name},emailRedirectTo:"".concat(window.location.origin,"/login")}});if(t)throw t;if(r.user){let{error:t}=await n.N.from("billing_users").insert({auth_user_id:r.user.id,email:b.email,full_name:y.full_name,role:b.role,is_active:!0,created_by:b.invited_by});if(t)throw t;await n.N.from("user_invites").update({status:"accepted",accepted_at:new Date().toISOString()}).eq("id",b.id),e.push("/login?message=Account created successfully. Please log in.")}}catch(e){console.error("Signup error:",e),k(e instanceof Error?e.message:"Failed to create account")}finally{v(!1)}}return((0,s.useEffect)(()=>{r?N():(m(!1),k("No invite token provided"))},[r]),t)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,a.jsx)(c,{className:"w-8 h-8 text-blue-500 animate-spin"})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 px-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(u.default,{src:"https://nexasync.ca/images/NexaSync-White.png",alt:"NexaSync Logo",width:220,height:60,className:"h-16 w-auto mx-auto mb-4"}),(0,a.jsx)("h1",{className:"text-3xl font-black gradient-text mb-2",children:"Create Your Account"}),(0,a.jsx)("p",{className:"text-gray-400",children:"NexaSync Billing Platform"})]}),g?(0,a.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-8",children:[(0,a.jsx)("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-4 mb-6",children:(0,a.jsxs)("p",{className:"text-sm text-blue-300",children:["You've been invited as ",(0,a.jsx)("strong",{children:"super_admin"===b.role?"Super Admin":"Admin"})," to ",b.email]})}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsx)(i.pd,{label:"Full Name",value:y.full_name,onChange:e=>h({...y,full_name:e.target.value}),required:!0}),(0,a.jsx)(i.pd,{label:"Email",type:"email",value:b.email,disabled:!0}),(0,a.jsx)(i.pd,{label:"Password",type:"password",value:y.password,onChange:e=>h({...y,password:e.target.value}),helperText:"Minimum 8 characters",required:!0}),(0,a.jsx)(i.pd,{label:"Confirm Password",type:"password",value:y.confirmPassword,onChange:e=>h({...y,confirmPassword:e.target.value}),required:!0}),j&&(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-300",children:j})}),(0,a.jsx)(d.$,{type:"submit",className:"w-full",loading:p,children:"Create Account"})]})]}):(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(o.A,{className:"w-6 h-6 text-red-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-400",children:"Invalid Invitation"}),(0,a.jsx)("p",{className:"text-sm text-red-300 mt-1",children:j})]})]})})]})})}function g(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,a.jsx)(c,{className:"w-8 h-8 text-blue-500 animate-spin"})}),children:(0,a.jsx)(m,{})})}},3941:(e,r,t)=>{"use strict";t.d(r,{N:()=>a});let a=(0,t(70945).UU)("https://cpkslvmydfdevdftieck.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNwa3Nsdm15ZGZkZXZkZnRpZWNrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY5MDAyOTUsImV4cCI6MjA2MjQ3NjI5NX0.IfkIVsp3AtLOyXDW9hq9bEvnozd9IaaUay244iDhWGE")},8829:(e,r,t)=>{"use strict";t.d(r,{TM:()=>l,l6:()=>n,pd:()=>s});var a=t(95155);function s(e){let{label:r,error:t,helperText:s,helpText:l,className:n="",...i}=e,d=s||l;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-200 mb-1",children:r}),(0,a.jsx)("input",{className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 ".concat(t?"border-red-500":"border-gray-300 dark:border-gray-600"," ").concat(n),...i}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:t}),d&&!t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:d})]})}function l(e){let{label:r,error:t,helperText:s,className:l="",...n}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-200 mb-1",children:r}),(0,a.jsx)("textarea",{className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 ".concat(t?"border-red-500":"border-gray-300 dark:border-gray-600"," ").concat(l),...n}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:t}),s&&!t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:s})]})}function n(e){let{label:r,error:t,helperText:s,options:l,className:n="",...i}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-200 mb-1",children:r}),(0,a.jsx)("select",{className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 ".concat(t?"border-red-500":"border-gray-300 dark:border-gray-600"," ").concat(n),...i,children:l.map(e=>(0,a.jsx)("option",{value:e.value,className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:e.label},e.value))}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:t}),s&&!t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:s})]})}t(12115)},70667:(e,r,t)=>{"use strict";t.d(r,{$:()=>s});var a=t(95155);function s(e){let{variant:r="primary",size:t="md",loading:s=!1,disabled:l,children:n,className:i="",...d}=e;return(0,a.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-blue-600 dark:bg-blue-500 text-white hover:bg-blue-700 dark:hover:bg-blue-600 focus:ring-blue-500 disabled:bg-blue-300 dark:disabled:bg-blue-800",secondary:"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 hover:bg-gray-300 dark:hover:bg-gray-600 focus:ring-gray-500 disabled:bg-gray-100 dark:disabled:bg-gray-800",danger:"bg-red-600 dark:bg-red-500 text-white hover:bg-red-700 dark:hover:bg-red-600 focus:ring-red-500 disabled:bg-red-300 dark:disabled:bg-red-800",ghost:"bg-transparent text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:ring-gray-500"}[r]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[t]," ").concat(i," ").concat(l||s?"cursor-not-allowed opacity-50":""),disabled:l||s,...d,children:[s&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})}t(12115)},78874:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(71847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},83011:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return s}});let a=t(12115);function s(e,r){let t=(0,a.useRef)(null),s=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=t.current;e&&(t.current=null,e());let r=s.current;r&&(s.current=null,r())}else e&&(t.current=l(e,a)),r&&(s.current=l(r,a))},[e,r])}function l(e,r){if("function"!=typeof e)return e.current=r,()=>{e.current=null};{let t=e(r);return"function"==typeof t?t:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},84662:(e,r,t)=>{Promise.resolve().then(t.bind(t,314))}},e=>{e.O(0,[143,394,441,255,358],()=>e(e.s=84662)),_N_E=e.O()}]);